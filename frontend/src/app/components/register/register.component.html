<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-4">
  <div class="bg-white rounded-lg w-full max-w-md shadow-xl transform transition-all" (click)="$event.stopPropagation()">
    <div class="flex items-center justify-between p-6 border-b border-gray-200">
      <h2 class="text-2xl font-semibold text-gray-800">Register</h2>
      <button (click)="onClose()" class="text-gray-500 hover:text-gray-700 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    <div class="p-6">
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <div *ngIf="errorMessage" class="mb-4 p-4 bg-red-50 border-l-4 border-red-500 text-red-700">
          {{ errorMessage }}
        </div>
        <div *ngIf="sucessMessage" class="mb-4 p-4 bg-red-50 border-l-4 border-green-500 text-green-700">
            {{ sucessMessage }}
          </div>
        <div class="mb-4">
          <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
          <input id="username" type="text" formControlName="username" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngClass]="{'border-red-500': registerForm.get('username')?.invalid && registerForm.get('username')?.touched, 'border-gray-300': !registerForm.get('username')?.invalid || !registerForm.get('username')?.touched}" />
          <div *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched" class="mt-1 text-sm text-red-600">
            <span *ngIf="registerForm.get('username')?.errors?.['required']">Username is required</span>
          </div>
        </div>

        <div class="mb-4">
          <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input id="email" type="email" formControlName="email" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngClass]="{'border-red-500': registerForm.get('email')?.invalid && registerForm.get('email')?.touched, 'border-gray-300': !registerForm.get('email')?.invalid || !registerForm.get('email')?.touched}" />
          <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="mt-1 text-sm text-red-600">
            <span *ngIf="registerForm.get('email')?.errors?.['required']">Email is required</span>
            <span *ngIf="registerForm.get('email')?.errors?.['email']">Invalid email address</span>
          </div>
        </div>

        <div class="mb-4">
          <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
          <input id="password" type="password" formControlName="password" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngClass]="{'border-red-500': registerForm.get('password')?.invalid && registerForm.get('password')?.touched, 'border-gray-300': !registerForm.get('password')?.invalid || !registerForm.get('password')?.touched}" />
          <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="mt-1 text-sm text-red-600">
            <span *ngIf="registerForm.get('password')?.errors?.['required']">Password is required</span>
            <span *ngIf="registerForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
          </div>
        </div>

        <div class="mb-4">
          <label for="retypePassword" class="block text-sm font-medium text-gray-700 mb-1">Retype Password</label>
          <input id="retypePassword" type="password" formControlName="retypePassword" class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            [ngClass]="{'border-red-500': registerForm.get('retypePassword')?.invalid && registerForm.get('retypePassword')?.touched, 'border-gray-300': !registerForm.get('retypePassword')?.invalid || !registerForm.get('retypePassword')?.touched}" />
          <div *ngIf="registerForm.get('retypePassword')?.invalid && registerForm.get('retypePassword')?.touched" class="mt-1 text-sm text-red-600">
            <span *ngIf="registerForm.get('retypePassword')?.errors?.['required']">Retype Password is required</span>
            <span *ngIf="registerForm.get('retypePassword')?.errors?.['minlength']">Retype Password must be at least 6 characters</span>
            <span *ngIf="registerForm.errors?.['mismatch']">Passwords do not match</span>
          </div>
        </div>

        <button type="submit" [disabled]="registerForm.invalid || isLoading" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200">
          <span *ngIf="!isLoading">Register</span>
          <div *ngIf="isLoading" class="inline-block animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-white"></div>
        </button>
        <!--  Additional Links  -->
        <div class="mt-4 text-center text-sm text-gray-600">
            <span>Already have an account?</span>
            <span class="mx-2">|</span>
            <a  (click)="onClose(); openLoginForm()" class="text-blue-600 hover:text-blue-700 hover:cursor-pointer">Login</a>
          </div>
      </form>
    </div>
  </div>
</div>